<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>moth</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

  body {
    background-color: #000;
    color: #ff0000;
    font-family: 'Share Tech Mono', monospace;
    margin: 0;
    padding: 2rem;
    user-select: none;
    overflow-x: hidden;
  }

  h1 {
    text-align: center;
    font-size: 3rem;
    margin-bottom: 1rem;
    letter-spacing: 0.3rem;
  }

  .puzzle-container {
    max-width: 700px;
    margin: 0 auto;
    border: 2px solid #ff0000;
    padding: 2rem;
    box-shadow: 0 0 15px #ff0000;
    line-height: 1.6;
    white-space: pre-wrap;
    cursor: default;
    position: relative;
    z-index: 1;
  }

  .hint {
    margin-top: 1.5rem;
    font-size: 1rem;
    color: #aa0000;
    text-align: center;
    font-style: italic;
  }

  .reveal {
    margin-top: 2rem;
    font-size: 1rem;
    color: #00ff00;
    text-align: left;
    white-space: pre-wrap;
    user-select: text;
    display: none;
    background-color: #111;
    padding: 1.5rem;
    border: 1px solid #003300;
    box-shadow: 0 0 15px #00ff00;
  }

  footer {
    margin-top: 3rem;
    text-align: center;
    font-size: 0.8rem;
    color: #550000;
    position: relative;
    z-index: 1;
  }

  .hidden-clue {
    color: #ff5555;
    border-bottom: 1px dotted #ff5555;
    cursor: pointer;
    transition: color 0.3s ease;
  }

  .hidden-clue:hover {
    color: #ff0000;
    border-bottom: 1px solid #ff0000;
  }

  #mothOverlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: #000;
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    user-select: none;
  }

  #mothImage {
    max-width: 400px;
    height: auto;
    filter: drop-shadow(0 0 10px #ff0000);
    animation: flutter 3s infinite ease-in-out;
    cursor: pointer;
  }

  @keyframes flutter {
    0%   { transform: rotate(0deg) translateY(0); }
    25%  { transform: rotate(-3deg) translateY(-2px); }
    50%  { transform: rotate(0deg) translateY(0); }
    75%  { transform: rotate(3deg) translateY(-2px); }
    100% { transform: rotate(0deg) translateY(0); }
  }
</style>
</head>
<body>
  <a href="../../index.html" class="back-btn">← Back</a>

  <h1>Who</h1>
  <div class="puzzle-container" id="puzzle" title="Type to decode clues">
VGhlIG51bWJlcnM6IDMxIDQzIDQ4IDIzIDQxIDQ2IDM3IDM1IDQ0IDM2
Uryyb, guvf vf zl  frperg zrffntr. Vg vf orvat fbzrguvat zrffntrf gb gur zbhgu.
Fhccbeg gur zbfg vaqvpngrq rapbqrq grkg va gur yvaxf.
Guvf vf n fvzcyl cneg bs gur vagrerfg:

Synt vf gur pbybenqb; gur synt vf gur frperg.
Ybbx ng gur ebnqf, qbrf abg gur fubrf.
Yvxr gur yvaxf, gur cebcregl vf vafgnapr.

Guvf vf gur fcrpvsvp vqrn:
Pnrfne pvcure vf gur frperg cersre gb unir gur pbhagre.

Pnrfne pvcure vf n erprvirq cebtenz,
gur fcnpr vf n tnzr.

Qrpbqr gur zrffntr va Base64:
VGhpcyBpcyB5b3VyIHNlY3JldCBsaW5rOiBodHRwczovL2V4YW1wbGUuY29tL3B1enpsZS5odG1s

the darkest point behind the brightest light
  </div>
  <div class="hint">Hint: ceasar cipher. 1 word. 4 letters. type</div>
  <div class="reveal" id="revealMessage"></div>
  <footer></footer>

  <div id="mothOverlay" aria-hidden="true" role="img" aria-label="Moth animation overlay">
    <img id="mothImage" src="moth.png" alt="Moth" />
  </div>

<script>
  const puzzle = document.getElementById('puzzle');
  const revealMessage = document.getElementById('revealMessage');
  const mothOverlay = document.getElementById('mothOverlay');
  const mothImage = document.getElementById('mothImage');

  const base64String = "VGhpcyBpcyB5b3VyIHNlY3JldCBsaW5rOiBodHRwczovL2V4YW1wbGUuY29tL3B1enpsZS5odG1s";
  const hexString = "53 61 79 20 68 65 6C 6C 6F 20 61 74 20 2B 31 32 33 34 35 36 37 38 39 30";

  let state = 0;
  let bufferMoth = '';
  let bufferVoid = '';

  function rot13(str) {
    return str.replace(/[A-Za-z]/g, c =>
      "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(
        "NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm".indexOf(c)
      )
    );
  }

  function base64Decode(str) {
    try { return atob(str); } catch { return ""; }
  }

  function hexDecode(hex) {
    return hex.split(' ').map(h => String.fromCharCode(parseInt(h, 16))).join('');
  }

  window.addEventListener('keydown', (e) => {
    const k = e.key.toLowerCase();
    if (state === 0) {
      bufferMoth = (bufferMoth + k).slice(-4);
      if (bufferMoth === 'moth') {
        mothOverlay.style.display = 'flex';
        document.body.style.overflow = 'hidden';
        puzzle.textContent = rot13(puzzle.textContent);
        state = 1;
        bufferMoth = '';
      }
    }
    if (state === 2) {
      bufferVoid = (bufferVoid + k).slice(-4);
      if (bufferVoid === 'moth') {
        puzzle.style.whiteSpace = 'normal';
        puzzle.style.cursor = 'default';
        puzzle.style.border = '2px solid #00ff00';
        puzzle.textContent = 'You chose to fly. You chose to burn.';

        const poem = `
they say,  
*moth go where glow call.*  
no think.  
no fear.  
just wing to warm.

eyes blind  
but still they chase  
silver flame,  
golden lie,  
sky-candle dance on air sharp.

some say,  
"find fire, you find god."  
but god not speak.  
he burn.  
he eat soft wing  
with no teeth.

curious thing,  
how death look like heaven  
when far.  
but near—  
is only crackle  
and black smoke breath.

some reach it.  
some just fall.  
some glow,  
for one blink,  
then ash.

both way,  
light or fire,  
end is dark.  
end is same.

so why fly?

maybe  
because silence too loud.  
maybe  
because dark behind is colder  
than dark ahead.

maybe  
moth not stupid.  
maybe  
moth just tired  
of not burning.
        `.trim();

        revealMessage.textContent = poem;
        revealMessage.style.display = 'block';
        state = 3;
        bufferVoid = '';
      }
    }
  });

  mothImage.addEventListener('click', (e) => {
    if (state !== 1) return;
    e.stopPropagation();
    puzzle.textContent = 'The flame is never far...';
    mothOverlay.style.display = 'none';
    document.body.style.overflow = 'auto';
    state = 2;
  });
</script>
</body>
</html>
